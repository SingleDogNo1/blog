"use strict";$(function(){var e,r,n,o,a,s,t=100,l=50,c=50,p=0,E=0,i=window.innerWidth/2;window.innerHeight;(e=document.createElement("div")).style.position="fixed",e.style.top="0px",e.style.left="0px",e.style.zIndex="-1",e.style.opacity="0.5",document.body.appendChild(e),(r=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,1,1e4)).position.z=1e3,n=new THREE.Scene,a=new Array;for(var d=2*Math.PI,h=new THREE.SpriteCanvasMaterial({color:10263708,program:function(e){e.beginPath(),e.arc(0,0,.5,0,d,!0),e.fill()}}),f=0,m=0;m<l;m++)for(var v=0;v<c;v++)(s=a[f++]=new THREE.Sprite(h)).position.x=m*t-l*t/2,s.position.z=v*t-c*t/2,n.add(s);function u(){i=window.innerWidth/2,window.innerHeight,r.aspect=window.innerWidth/window.innerHeight,r.updateProjectionMatrix(),o.setSize(window.innerWidth,window.innerHeight)}function x(e){E=e.clientX-i}function R(){r.position.x+=.05*(E-r.position.x),r.position.y=362.05,r.lookAt({x:n.position.x,y:window.innerHeight/3,z:n.position.z});for(var e=0,t=0;t<l;t++)for(var i=0;i<c;i++)(s=a[e++]).position.y=50*Math.sin(.3*(t+p))+50*Math.sin(.5*(i+p)),s.scale.x=s.scale.y=4*(Math.sin(.3*(t+p))+1)+4*(Math.sin(.5*(i+p))+1);o.render(n,r),p+=.1}(o=new THREE.CanvasRenderer).setPixelRatio(window.devicePixelRatio),o.setSize(window.innerWidth,window.innerHeight),o.setClearColor(16119801,0),e.appendChild(o.domElement),document.addEventListener("mousemove",x,!1),window.addEventListener("resize",u,!1),function e(){requestAnimationFrame(e);R()}()}),THREE.RenderableObject=function(){this.id=0,this.object=null,this.z=0,this.renderOrder=0},THREE.RenderableFace=function(){this.id=0,this.v1=new THREE.RenderableVertex,this.v2=new THREE.RenderableVertex,this.v3=new THREE.RenderableVertex,this.normalModel=new THREE.Vector3,this.vertexNormalsModel=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],this.vertexNormalsLength=0,this.color=new THREE.Color,this.material=null,this.uvs=[new THREE.Vector2,new THREE.Vector2,new THREE.Vector2],this.z=0,this.renderOrder=0},THREE.RenderableVertex=function(){this.position=new THREE.Vector3,this.positionWorld=new THREE.Vector3,this.positionScreen=new THREE.Vector4,this.visible=!0},THREE.RenderableVertex.prototype.copy=function(e){this.positionWorld.copy(e.positionWorld),this.positionScreen.copy(e.positionScreen)},THREE.RenderableLine=function(){this.id=0,this.v1=new THREE.RenderableVertex,this.v2=new THREE.RenderableVertex,this.vertexColors=[new THREE.Color,new THREE.Color],this.material=null,this.z=0,this.renderOrder=0},THREE.RenderableSprite=function(){this.id=0,this.object=null,this.x=0,this.y=0,this.z=0,this.rotation=0,this.scale=new THREE.Vector2,this.material=null,this.renderOrder=0},THREE.Projector=function(){var oe,ae,n,se,le,ce,pe,Ee,de,he,fe,me=[],ve=0,ue=[],t=0,i=[],r=0,o=[],a=0,xe=[],Re=0,ye={objects:[],lights:[],elements:[]},Te=new THREE.Vector3,we=new THREE.Vector4,f=new THREE.Box3(new THREE.Vector3(-1,-1,-1),new THREE.Vector3(1,1,1)),m=new THREE.Box3,h=new Array(3),He=(new Array(4),new THREE.Matrix4),ge=new THREE.Matrix4,Se=new THREE.Matrix4,Me=new THREE.Matrix3,Ce=new THREE.Frustum,be=new THREE.Vector4,ze=new THREE.Vector4,Ve=(this.projectVector=function(e,t){console.warn("THREE.Projector: .projectVector() is now vector.project()."),e.project(t)},this.unprojectVector=function(e,t){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),e.unproject(t)},this.pickingRay=function(e,t){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")},new function(){var a=[],s=[],l=null,c=null,p=new THREE.Matrix3;function r(e){var t=e.position,i=e.positionWorld,r=e.positionScreen,t=(i.copy(t).applyMatrix4(fe),r.copy(i).applyMatrix4(ge),1/r.w);r.x*=t,r.y*=t,r.z*=t,e.visible=-1<=r.x&&r.x<=1&&-1<=r.y&&r.y<=1&&-1<=r.z&&r.z<=1}function E(e,t,i){return!0===e.visible||!0===t.visible||!0===i.visible||(h[0]=e.positionScreen,h[1]=t.positionScreen,h[2]=i.positionScreen,f.intersectsBox(m.setFromPoints(h)))}function d(e,t,i){return(i.positionScreen.x-e.positionScreen.x)*(t.positionScreen.y-e.positionScreen.y)-(i.positionScreen.y-e.positionScreen.y)*(t.positionScreen.x-e.positionScreen.x)<0}return{setObject:function(e){c=(l=e).material,p.getNormalMatrix(l.matrixWorld),s.length=a.length=0},projectVertex:r,checkTriangleVisibility:E,checkBackfaceCulling:d,pushVertex:function(e,t,i){(n=je()).position.set(e,t,i),r(n)},pushNormal:function(e,t,i){a.push(e,t,i)},pushUv:function(e,t){s.push(e,t)},pushLine:function(e,t){e=ue[e],t=ue[t],(pe=Oe()).id=l.id,pe.v1.copy(e),pe.v2.copy(t),pe.z=(e.positionScreen.z+t.positionScreen.z)/2,pe.renderOrder=l.renderOrder,pe.material=l.material,ye.elements.push(pe)},pushTriangle:function(e,t,i){var r=ue[e],t=ue[t],i=ue[i];if(!1!==E(r,t,i)&&(c.side===THREE.DoubleSide||!0===d(r,t,i))){(le=Le()).id=l.id,le.v1.copy(r),le.v2.copy(t),le.v3.copy(i),le.z=(r.positionScreen.z+t.positionScreen.z+i.positionScreen.z)/3,le.renderOrder=l.renderOrder,le.normalModel.fromArray(a,3*e),le.normalModel.applyMatrix3(p).normalize();for(var n=0;n<3;n++){var o=le.vertexNormalsModel[n];o.fromArray(a,3*arguments[n]),o.applyMatrix3(p).normalize(),le.uvs[n].fromArray(s,2*arguments[n])}le.vertexNormalsLength=3,le.material=l.material,ye.elements.push(le)}}}});function je(){var e;return se===t?(e=new THREE.RenderableVertex,ue.push(e),t++,se++,e):ue[se++]}function Le(){var e;return ce===r?(e=new THREE.RenderableFace,i.push(e),r++,ce++,e):i[ce++]}function Oe(){var e;return Ee===a?(e=new THREE.RenderableLine,o.push(e),a++,Ee++,e):o[Ee++]}function Be(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id!==t.id?e.id-t.id:0}this.projectScene=function(e,t,P,k){function N(e){var t;(oe=ae!==ve?me[ae++]:(t=new THREE.RenderableObject,me.push(t),ve++,ae++,t)).id=e.id,oe.object=e,Te.setFromMatrixPosition(e.matrixWorld),Te.applyMatrix4(ge),oe.z=Te.z,oe.renderOrder=e.renderOrder,ye.objects.push(oe)}he=Ee=ce=0,!(ye.elements.length=0)===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),He.copy(t.matrixWorldInverse.getInverse(t.matrixWorld)),ge.multiplyMatrices(t.projectionMatrix,He),Ce.setFromMatrix(ge),ae=0,ye.objects.length=0,ye.lights.length=0,e.traverseVisible(function(e){e instanceof THREE.Light?ye.lights.push(e):e instanceof THREE.Mesh||e instanceof THREE.Line?!1===e.material.visible||!0===e.frustumCulled&&!1===Ce.intersectsObject(e)||N(e):e instanceof THREE.Sprite&&(!1===e.material.visible||!0===e.frustumCulled&&!1===Ce.intersectsSprite(e)||N(e))}),!0===P&&ye.objects.sort(Be);for(var i,r,n,o,a,s,l,c,p,F=0,A=ye.objects.length;F<A;F++){var E,d=ye.objects[F].object,h=d.geometry;if(Ve.setObject(d),fe=d.matrixWorld,se=0,d instanceof THREE.Mesh){if(h instanceof THREE.BufferGeometry){var f=h.attributes,I=h.groups;if(void 0!==f.position){for(var m=0,v=(W=f.position.array).length;m<v;m+=3)Ve.pushVertex(W[m],W[m+1],W[m+2]);if(void 0!==f.normal)for(var u=f.normal.array,m=0,v=u.length;m<v;m+=3)Ve.pushNormal(u[m],u[m+1],u[m+2]);if(void 0!==f.uv)for(var D=f.uv.array,m=0,v=D.length;m<v;m+=2)Ve.pushUv(D[m],D[m+1]);if(null!==h.index){var x=h.index.array;if(0<I.length)for(var G=0;G<I.length;G++)for(var U=I[G],m=U.start,v=U.start+U.count;m<v;m+=3)Ve.pushTriangle(x[m],x[m+1],x[m+2]);else for(m=0,v=x.length;m<v;m+=3)Ve.pushTriangle(x[m],x[m+1],x[m+2])}else for(m=0,v=W.length/3;m<v;m+=3)Ve.pushTriangle(m,m+1,m+2)}}else if(h instanceof THREE.Geometry){var R=h.vertices,q=h.faces,J=h.faceVertexUvs[0];Me.getNormalMatrix(fe);for(var X=(C=d.material)instanceof THREE.MultiMaterial,$=!0==X?d.material:null,y=0,K=R.length;y<K;y++){var T=R[y];if(Te.copy(T),!0===C.morphTargets)for(var Q=h.morphTargets,Y=d.morphTargetInfluences,w=0,Z=Q.length;w<Z;w++){var H,g=Y[w];0!==g&&(H=Q[w].vertices[y],Te.x+=(H.x-T.x)*g,Te.y+=(H.y-T.y)*g,Te.z+=(H.z-T.z)*g)}Ve.pushVertex(Te.x,Te.y,Te.z)}for(var S=0,_=q.length;S<_;S++){var M=q[S],C=!0==X?$.materials[M.materialIndex]:d.material;if(void 0!==C){var b=C.side,z=ue[M.a],V=ue[M.b],j=ue[M.c];if(!1!==Ve.checkTriangleVisibility(z,V,j)){var L=Ve.checkBackfaceCulling(z,V,j);if(b!==THREE.DoubleSide){if(b===THREE.FrontSide&&!1===L)continue;if(b===THREE.BackSide&&!0===L)continue}(le=Le()).id=d.id,le.v1.copy(z),le.v2.copy(V),le.v3.copy(j),le.normalModel.copy(M.normal),!1!==L||b!==THREE.BackSide&&b!==THREE.DoubleSide||le.normalModel.negate(),le.normalModel.applyMatrix3(Me).normalize();for(var ee=M.vertexNormals,O=0,te=Math.min(ee.length,3);O<te;O++){var ie=le.vertexNormalsModel[O];ie.copy(ee[O]),!1!==L||b!==THREE.BackSide&&b!==THREE.DoubleSide||ie.negate(),ie.applyMatrix3(Me).normalize()}le.vertexNormalsLength=ee.length;var re=J[S];if(void 0!==re)for(var B=0;B<3;B++)le.uvs[B].copy(re[B]);le.color=M.color,le.material=C,le.z=(z.positionScreen.z+V.positionScreen.z+j.positionScreen.z)/3,le.renderOrder=d.renderOrder,ye.elements.push(le)}}}}}else if(d instanceof THREE.Line){if(h instanceof THREE.BufferGeometry){if(void 0!==(f=h.attributes).position){for(var W,m=0,v=(W=f.position.array).length;m<v;m+=3)Ve.pushVertex(W[m],W[m+1],W[m+2]);if(null!==h.index)for(m=0,v=(x=h.index.array).length;m<v;m+=2)Ve.pushLine(x[m],x[m+1]);else for(var ne=d instanceof THREE.LineSegments?2:1,m=0,v=W.length/3-1;m<v;m+=ne)Ve.pushLine(m,m+1)}}else if(h instanceof THREE.Geometry){Se.multiplyMatrices(ge,fe);R=d.geometry.vertices;if(0!==R.length){(z=je()).positionScreen.copy(R[0]).applyMatrix4(Se);for(ne=d instanceof THREE.LineSegments?2:1,y=1,K=R.length;y<K;y++)(z=je()).positionScreen.copy(R[y]).applyMatrix4(Se),0<(y+1)%ne||(V=ue[se-2],be.copy(z.positionScreen),ze.copy(V.positionScreen),!0==(n=ze,p=c=l=s=a=o=void 0,o=0,a=1,s=(r=be).z+r.w,l=n.z+n.w,c=-r.z+r.w,p=-n.z+n.w,0<=s&&0<=l&&0<=c&&0<=p||!(s<0&&l<0||c<0&&p<0||(s<0?o=Math.max(o,s/(s-l)):l<0&&(a=Math.min(a,s/(s-l))),c<0?o=Math.max(o,c/(c-p)):p<0&&(a=Math.min(a,c/(c-p))),a<o)||(r.lerp(n,o),n.lerp(r,1-a),0)))&&(be.multiplyScalar(1/be.w),ze.multiplyScalar(1/ze.w),(pe=Oe()).id=d.id,pe.v1.positionScreen.copy(be),pe.v2.positionScreen.copy(ze),pe.z=Math.max(be.z,ze.z),pe.renderOrder=d.renderOrder,pe.material=d.material,d.material.vertexColors===THREE.VertexColors&&(pe.vertexColors[0].copy(d.geometry.colors[y]),pe.vertexColors[1].copy(d.geometry.colors[y-1])),ye.elements.push(pe)))}}}else d instanceof THREE.Sprite&&(we.set(fe.elements[12],fe.elements[13],fe.elements[14],1),we.applyMatrix4(ge),E=1/we.w,we.z*=E,-1<=we.z)&&we.z<=1&&(i=void 0,(de=he!==Re?xe[he++]:(i=new THREE.RenderableSprite,xe.push(i),Re++,he++,i)).id=d.id,de.x=we.x*E,de.y=we.y*E,de.z=we.z,de.renderOrder=d.renderOrder,de.object=d,de.rotation=d.rotation,de.scale.x=d.scale.x*Math.abs(de.x-(we.x+t.projectionMatrix.elements[0])/(we.w+t.projectionMatrix.elements[12])),de.scale.y=d.scale.y*Math.abs(de.y-(we.y+t.projectionMatrix.elements[5])/(we.w+t.projectionMatrix.elements[13])),de.material=d.material,ye.elements.push(de))}return!0===k&&ye.elements.sort(Be),ye}},THREE.SpriteCanvasMaterial=function(e){THREE.Material.call(this),this.type="SpriteCanvasMaterial",this.color=new THREE.Color(16777215),this.program=function(e,t){},this.setValues(e)},THREE.SpriteCanvasMaterial.prototype=Object.create(THREE.Material.prototype),THREE.SpriteCanvasMaterial.prototype.constructor=THREE.SpriteCanvasMaterial,THREE.SpriteCanvasMaterial.prototype.clone=function(){var e=new THREE.SpriteCanvasMaterial;return e.copy(this),e.color.copy(this.color),e.program=this.program,e},THREE.CanvasRenderer=function(e){console.log("THREE.CanvasRenderer",THREE.REVISION),e=e||{};var k,N,F,A,I,D,G,U,q,J,X,$,de,he,fe,me,ve,K=this,ue=new THREE.Projector,r=void 0!==e.canvas?e.canvas:document.createElement("canvas"),Q=r.width,Y=r.height,Z=Math.floor(Q/2),_=Math.floor(Y/2),xe=0,Re=0,ye=Q,Te=Y,n=1,ee=r.getContext("2d",{alpha:!0===e.alpha}),i=new THREE.Color(0),o=!0===e.alpha?0:1,a=1,s=0,l=null,c=null,p=null,E=null,d=null,t=[],te=(new THREE.RenderableVertex,new THREE.RenderableVertex,new THREE.Color),we=(new THREE.Color,new THREE.Color,new THREE.Color,new THREE.Color,new THREE.Color),He=new THREE.Color,ge=new THREE.Color,ie={},re=new THREE.Box2,ne=new THREE.Box2,oe=new THREE.Box2,Se=new THREE.Color,Me=new THREE.Color,Ce=new THREE.Color,be=new THREE.Vector3,ze=new THREE.Vector3,ae=new THREE.Vector3,se=new THREE.Matrix3;function Ve(e,t,i,r){We(t),Pe(i),ke(r),pe(e.getStyle()),ee.stroke(),oe.expandByScalar(2*t)}function je(e){Ee(e.getStyle()),ee.fill()}function Le(e){var t,i,r,n,o,a,s;return 0===e.version||e instanceof THREE.CompressedTexture||e instanceof THREE.DataTexture?{canvas:void 0,version:e.version}:!1===(t=e.image).complete?{canvas:void 0,version:0}:(i=e.wrapS===THREE.RepeatWrapping||e.wrapS===THREE.MirroredRepeatWrapping,r=e.wrapT===THREE.RepeatWrapping||e.wrapT===THREE.MirroredRepeatWrapping,a=e.wrapS===THREE.MirroredRepeatWrapping,s=e.wrapT===THREE.MirroredRepeatWrapping,(n=document.createElement("canvas")).width=t.width*(a?2:1),n.height=t.height*(s?2:1),(o=n.getContext("2d")).setTransform(1,0,0,-1,0,t.height),o.drawImage(t,0,0),!0==a&&(o.setTransform(-1,0,0,-1,t.width,t.height),o.drawImage(t,-t.width,0)),!0==s&&(o.setTransform(1,0,0,1,0,0),o.drawImage(t,0,t.height)),!0==a&&!0==s&&(o.setTransform(-1,0,0,1,t.width,0),o.drawImage(t,-t.width,t.height)),a="no-repeat",!0==i&&!0==r?a="repeat":!0==i?a="repeat-x":!0==r&&(a="repeat-y"),s=ee.createPattern(n,a),e.onUpdate&&e.onUpdate(e),{canvas:s,version:e.version})}function Oe(e,t,i,r,n,o,a,s,l,c,p,E,d){var h,f,m=ie[d.id];void 0!==m&&m.version===d.version||(m=Le(d),ie[d.id]=m),void 0===m.canvas?(Ee("rgba( 0, 0, 0, 1)"),ee.fill()):(Ee(m.canvas),m=d.offset.x/d.repeat.x,h=d.offset.y/d.repeat.y,l=(l+m)*(f=d.image.width*d.repeat.x),c=(c+h)*(d=d.image.height*d.repeat.y),p=(p+m)*f,E=(E+h)*d,i-=e,r-=t,n-=e,o-=t,0!=(m=(l-=a=(a+m)*f)*(E-=s=(s+h)*d)-(p-=a)*(c-=s))&&(e=e-(h=(E*i-c*n)*(f=1/m))*a-(d=(l*n-p*i)*f)*s,i=t-(m=(E*r-c*o)*f)*a-(n=(l*o-p*r)*f)*s,ee.save(),ee.transform(h,m,d,n,e,i),ee.fill(),ee.restore()))}function Be(e,t,i){var r=t.x-e.x,n=t.y-e.y,o=r*r+n*n;0!=o&&(n*=i=i/Math.sqrt(o),t.x+=r*=i,t.y+=n,e.x-=r,e.y-=n)}function le(e){a!==e&&(ee.globalAlpha=e,a=e)}function ce(e){s!==e&&(e===THREE.NormalBlending?ee.globalCompositeOperation="source-over":e===THREE.AdditiveBlending?ee.globalCompositeOperation="lighter":e===THREE.SubtractiveBlending?ee.globalCompositeOperation="darker":e===THREE.MultiplyBlending&&(ee.globalCompositeOperation="multiply"),s=e)}function We(e){p!==e&&(ee.lineWidth=e,p=e)}function Pe(e){E!==e&&(ee.lineCap=e,E=e)}function ke(e){d!==e&&(ee.lineJoin=e,d=e)}function pe(e){l!==e&&(ee.strokeStyle=e,l=e)}function Ee(e){c!==e&&(ee.fillStyle=e,c=e)}function Ne(e){t.length!==e.length&&(ee.setLineDash(e),t=e)}void 0===ee.setLineDash&&(ee.setLineDash=function(){}),this.domElement=r,this.autoClear=!0,this.sortObjects=!0,this.sortElements=!0,this.info={render:{vertices:0,faces:0}},this.supportsVertexTextures=function(){},this.setFaceCulling=function(){},this.getContext=function(){return ee},this.getContextAttributes=function(){return ee.getContextAttributes()},this.getPixelRatio=function(){return n},this.setPixelRatio=function(e){void 0!==e&&(n=e)},this.setSize=function(e,t,i){Q=e*n,Y=t*n,r.width=Q,r.height=Y,Z=Math.floor(Q/2),_=Math.floor(Y/2),!1!==i&&(r.style.width=e+"px",r.style.height=t+"px"),re.min.set(-Z,-_),re.max.set(Z,_),ne.min.set(-Z,-_),ne.max.set(Z,_),a=1,s=0,d=E=p=c=l=null,this.setViewport(0,0,e,t)},this.setViewport=function(e,t,i,r){xe=e*n,Re=t*n,ye=i*n,Te=r*n},this.setScissor=function(){},this.setScissorTest=function(){},this.setClearColor=function(e,t){i.set(e),o=void 0!==t?t:1,ne.min.set(-Z,-_),ne.max.set(Z,_)},this.setClearColorHex=function(e,t){console.warn("THREE.CanvasRenderer: .setClearColorHex() is being removed. Use .setClearColor() instead."),this.setClearColor(e,t)},this.getClearColor=function(){return i},this.getClearAlpha=function(){return o},this.getMaxAnisotropy=function(){return 0},this.clear=function(){!1===ne.isEmpty()&&(ne.intersect(re),ne.expandByScalar(2),ne.min.x=ne.min.x+Z,ne.min.y=-ne.min.y+_,ne.max.x=ne.max.x+Z,ne.max.y=-ne.max.y+_,o<1&&ee.clearRect(0|ne.min.x,0|ne.max.y,ne.max.x-ne.min.x|0,ne.min.y-ne.max.y|0),0<o&&(ce(THREE.NormalBlending),le(1),Ee("rgba("+Math.floor(255*i.r)+","+Math.floor(255*i.g)+","+Math.floor(255*i.b)+","+o+")"),ee.fillRect(0|ne.min.x,0|ne.max.y,ne.max.x-ne.min.x|0,ne.min.y-ne.max.y|0)),ne.makeEmpty())},this.clearColor=function(){},this.clearDepth=function(){},this.clearStencil=function(){},this.render=function(e,t){if(t instanceof THREE.Camera==!1)console.error("THREE.CanvasRenderer.render: camera is not an instance of THREE.Camera.");else{var i=e.background;i&&i.isColor?(Ee("rgb("+Math.floor(255*i.r)+","+Math.floor(255*i.g)+","+Math.floor(255*i.b)+")"),ee.fillRect(0,0,Q,Y)):!0===this.autoClear&&this.clear(),K.info.render.vertices=0,K.info.render.faces=0,ee.setTransform(ye/Q,0,0,-Te/Y,xe,Y-Re),ee.translate(Z,_),k=ue.projectScene(e,t,this.sortObjects,this.sortElements),N=k.elements,F=k.lights,se.getNormalMatrix(t.matrixWorldInverse),Se.setRGB(0,0,0),Me.setRGB(0,0,0),Ce.setRGB(0,0,0);for(var r=0,n=F.length;r<n;r++){var o=F[r],a=o.color;o instanceof THREE.AmbientLight?Se.add(a):o instanceof THREE.DirectionalLight?Me.add(a):o instanceof THREE.PointLight&&Ce.add(a)}for(var s,l,c=0,P=N.length;c<P;c++){var p=N[c],E=p.material;if(void 0!==E&&0!==E.opacity){if(oe.makeEmpty(),p instanceof THREE.RenderableSprite){(A=p).x*=Z,A.y*=_,u=y=R=x=T=v=m=f=h=d=void 0;var d=A,h=p,f=E,m=(le(f.opacity),ce(f.blending),h.scale.x*Z),h=h.scale.y*_,v=.5*Math.sqrt(m*m+h*h);oe.min.set(d.x-v,d.y-v),oe.max.set(d.x+v,d.y+v),f instanceof THREE.SpriteMaterial?null!==(v=f.map)?(void 0!==(T=ie[v.id])&&T.version===v.version||(T=Le(v),ie[v.id]=T),void 0!==T.canvas&&(Ee(T.canvas),T=v.image,x=T.width*v.offset.x,R=T.height*v.offset.y,y=T.width*v.repeat.x,T=T.height*v.repeat.y,v=m/y,u=h/T,ee.save(),ee.translate(d.x,d.y),0!==f.rotation&&ee.rotate(f.rotation),ee.translate(-m/2,-h/2),ee.scale(v,u),ee.translate(-x,-R),ee.fillRect(x,R,y,T),ee.restore())):(Ee(f.color.getStyle()),ee.save(),ee.translate(d.x,d.y),0!==f.rotation&&ee.rotate(f.rotation),ee.scale(m,-h),ee.fillRect(-.5,-.5,1,1),ee.restore()):f instanceof THREE.SpriteCanvasMaterial&&(pe(f.color.getStyle()),Ee(f.color.getStyle()),ee.save(),ee.translate(d.x,d.y),0!==f.rotation&&ee.rotate(f.rotation),ee.scale(m,h),f.program(ee),ee.restore())}else if(p instanceof THREE.RenderableLine){if(A=p.v1,I=p.v2,A.positionScreen.x*=Z,A.positionScreen.y*=_,I.positionScreen.x*=Z,I.positionScreen.y*=_,oe.setFromPoints([A.positionScreen,I.positionScreen]),!0===re.intersectsBox(oe)){T=y=R=x=u=v=void 0;var v=A,u=I,x=p,R=E;if(le(R.opacity),ce(R.blending),ee.beginPath(),ee.moveTo(v.positionScreen.x,v.positionScreen.y),ee.lineTo(u.positionScreen.x,u.positionScreen.y),R instanceof THREE.LineBasicMaterial){if(We(R.linewidth),Pe(R.linecap),ke(R.linejoin),R.vertexColors!==THREE.VertexColors)pe(R.color.getStyle());else{var y=x.vertexColors[0].getStyle(),x=x.vertexColors[1].getStyle();if(y===x)pe(y);else{try{var T=ee.createLinearGradient(v.positionScreen.x,v.positionScreen.y,u.positionScreen.x,u.positionScreen.y);T.addColorStop(0,y),T.addColorStop(1,x)}catch(e){T=y}pe(T)}}ee.stroke(),oe.expandByScalar(2*R.linewidth)}else R instanceof THREE.LineDashedMaterial&&(We(R.linewidth),Pe(R.linecap),ke(R.linejoin),pe(R.color.getStyle()),Ne([R.dashSize,R.gapSize]),ee.stroke(),oe.expandByScalar(2*R.linewidth),Ne([]))}}else if(p instanceof THREE.RenderableFace){if(A=p.v1,I=p.v2,D=p.v3,A.positionScreen.z<-1||1<A.positionScreen.z)continue;if(I.positionScreen.z<-1||1<I.positionScreen.z)continue;if(D.positionScreen.z<-1||1<D.positionScreen.z)continue;if(A.positionScreen.x*=Z,A.positionScreen.y*=_,I.positionScreen.x*=Z,I.positionScreen.y*=_,D.positionScreen.x*=Z,D.positionScreen.y*=_,0<E.overdraw&&(Be(A.positionScreen,I.positionScreen,E.overdraw),Be(I.positionScreen,D.positionScreen,E.overdraw),Be(D.positionScreen,A.positionScreen,E.overdraw)),oe.setFromPoints([A.positionScreen,I.positionScreen,D.positionScreen]),!0===re.intersectsBox(oe)){d=A,m=I,h=D,f=0,s=1,l=2,p=p,E=E,K.info.render.vertices+=3,K.info.render.faces++,le(E.opacity),ce(E.blending),D=d.positionScreen.x,G=d.positionScreen.y,U=m.positionScreen.x,q=m.positionScreen.y,J=h.positionScreen.x,X=h.positionScreen.y,C=M=S=g=H=w=void 0;var w=D,H=G,g=U,S=q,M=J,C=X;if(ee.beginPath(),ee.moveTo(w,H),ee.lineTo(g,S),ee.lineTo(M,C),ee.closePath(),(E instanceof THREE.MeshLambertMaterial||E instanceof THREE.MeshPhongMaterial)&&null===E.map){we.copy(E.color),He.copy(E.emissive),E.vertexColors===THREE.FaceColors&&we.multiply(p.color),te.copy(Se),ze.copy(d.positionWorld).add(m.positionWorld).add(h.positionWorld).divideScalar(3);{b=void 0;z=void 0;V=void 0;j=void 0;L=void 0;W=void 0;O=void 0;B=void 0;var b=ze;var z=p.normalModel;var V=te;for(var j=0,L=F.length;j<L;j++){var O,B,W=F[j];ge.copy(W.color),W instanceof THREE.DirectionalLight?(O=be.setFromMatrixPosition(W.matrixWorld).normalize(),(B=z.dot(O))<=0||(B*=W.intensity,V.add(ge.multiplyScalar(B)))):W instanceof THREE.PointLight&&(O=be.setFromMatrixPosition(W.matrixWorld),(B=z.dot(be.subVectors(O,b).normalize()))<=0||0!=(B*=0==W.distance?1:1-Math.min(b.distanceTo(O)/W.distance,1))&&(B*=W.intensity,V.add(ge.multiplyScalar(B))))}}te.multiply(we).add(He),!0===E.wireframe?Ve(te,E.wireframeLinewidth,E.wireframeLinecap,E.wireframeLinejoin):je(te)}else E instanceof THREE.MeshBasicMaterial||E instanceof THREE.MeshLambertMaterial||E instanceof THREE.MeshPhongMaterial?null!==E.map?E.map.mapping===THREE.UVMapping&&($=p.uvs,Oe(D,G,U,q,J,X,$[f].x,$[f].y,$[s].x,$[s].y,$[l].x,$[l].y,E.map)):null!==E.envMap?E.envMap.mapping===THREE.SphericalReflectionMapping&&(ae.copy(p.vertexNormalsModel[f]).applyMatrix3(se),$=.5*ae.x+.5,de=.5*ae.y+.5,ae.copy(p.vertexNormalsModel[s]).applyMatrix3(se),he=.5*ae.x+.5,fe=.5*ae.y+.5,ae.copy(p.vertexNormalsModel[l]).applyMatrix3(se),me=.5*ae.x+.5,ve=.5*ae.y+.5,Oe(D,G,U,q,J,X,$,de,he,fe,me,ve,E.envMap)):(te.copy(E.color),E.vertexColors===THREE.FaceColors&&te.multiply(p.color),!0===E.wireframe?Ve(te,E.wireframeLinewidth,E.wireframeLinecap,E.wireframeLinejoin):je(te)):(E instanceof THREE.MeshNormalMaterial?(ae.copy(p.normalModel).applyMatrix3(se),te.setRGB(ae.x,ae.y,ae.z).multiplyScalar(.5).addScalar(.5)):te.setRGB(1,1,1),!0===E.wireframe?Ve(te,E.wireframeLinewidth,E.wireframeLinecap,E.wireframeLinejoin):je(te))}}ne.union(oe)}}ee.setTransform(1,0,0,1,0,0)}}};