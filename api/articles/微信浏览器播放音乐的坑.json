{"title":"微信浏览器播放音乐的坑","slug":"微信浏览器播放音乐的坑","date":"2017-10-30T07:37:36.000Z","updated":"2023-06-21T08:55:09.216Z","comments":true,"path":"api/articles/微信浏览器播放音乐的坑.json","excerpt":null,"covers":null,"content":"<h2 id=\"如果只是简单的希望向微信环境下添加默认播放的背景音乐而不需要其他操作\"><a href=\"#如果只是简单的希望向微信环境下添加默认播放的背景音乐而不需要其他操作\" class=\"headerlink\" title=\"如果只是简单的希望向微信环境下添加默认播放的背景音乐而不需要其他操作\"></a>如果只是简单的希望向微信环境下添加默认播放的背景音乐而不需要其他操作</h2><h3 id=\"给你的-js绑定微信浏览器特有的事件\"><a href=\"#给你的-js绑定微信浏览器特有的事件\" class=\"headerlink\" title=\"给你的 js绑定微信浏览器特有的事件\"></a>给你的 js绑定微信浏览器特有的事件</h3><div class=\"code-panel__wrapper\" autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\"><header class=\"mac-panel\"><span class=\"doc-path\"></span><span class=\"mac-panel__language\">HTML</span></header><figure class=\"iseeu highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">audio</span> <span class=\"attr\">id</span>=<span class=\"string\">\"audio\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"media-audio\"</span> <span class=\"attr\">autoplay</span> <span class=\"attr\">preload</span> <span class=\"attr\">loop</span>=<span class=\"string\">\"loop\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">source</span> <span class=\"attr\">src</span>=<span class=\"string\">\"music.ogg\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"audio/ogg\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">source</span> <span class=\"attr\">src</span>=<span class=\"string\">\"music.mp3\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"audio/mpeg\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"comment\">&lt;!-- ... --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">audio</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"javascript\">   <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">audioAutoPlay</span>(<span class=\"params\">ID</span>)</span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">     <span class=\"keyword\">var</span> audio = <span class=\"built_in\">document</span>.getElementById(ID);</span></span><br><span class=\"line\">     audio.play();</span><br><span class=\"line\"><span class=\"javascript\">     <span class=\"built_in\">document</span>.addEventListener(<span class=\"string\">\"WeixinJSBridgeReady\"</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\">       audio.play();</span><br><span class=\"line\"><span class=\"javascript\">     &#125;, <span class=\"literal\">false</span>);</span></span><br><span class=\"line\"><span class=\"javascript\">     <span class=\"built_in\">document</span>.addEventListener(<span class=\"string\">'YixinJSBridgeReady'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\">       audio.play();</span><br><span class=\"line\"><span class=\"javascript\">     &#125;, <span class=\"literal\">false</span>);</span></span><br><span class=\"line\">   &#125;</span><br><span class=\"line\"><span class=\"javascript\">   audioAutoPlay(<span class=\"string\">'audio'</span>);</span></span><br><span class=\"line\"> <span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure></div>\n<h2 id=\"如果有关于微信SDK的操作，将这段逻辑放在SDK中也是极好的\"><a href=\"#如果有关于微信SDK的操作，将这段逻辑放在SDK中也是极好的\" class=\"headerlink\" title=\"如果有关于微信SDK的操作，将这段逻辑放在SDK中也是极好的\"></a>如果有关于微信SDK的操作，将这段逻辑放在SDK中也是极好的</h2><h3 id=\"博主默认你已经正确的引用了-SDK，如果无法引用请查找其他文档\"><a href=\"#博主默认你已经正确的引用了-SDK，如果无法引用请查找其他文档\" class=\"headerlink\" title=\"博主默认你已经正确的引用了 SDK，如果无法引用请查找其他文档\"></a>博主默认你已经正确的引用了 SDK，如果无法引用请查找其他文档</h3><div class=\"code-panel__wrapper\" autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\"><header class=\"mac-panel\"><span class=\"doc-path\"></span><span class=\"mac-panel__language\">JS</span></header><figure class=\"iseeu highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// ...</span></span><br><span class=\"line\">wx.config(&#123;</span><br><span class=\"line\">  <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;)</span><br><span class=\"line\">wx.ready(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">  <span class=\"comment\">// ...</span></span><br><span class=\"line\">  audio.play();</span><br><span class=\"line\">  <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;)</span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure></div>\n","more":"<h2 id=\"如果只是简单的希望向微信环境下添加默认播放的背景音乐而不需要其他操作\"><a href=\"#如果只是简单的希望向微信环境下添加默认播放的背景音乐而不需要其他操作\" class=\"headerlink\" title=\"如果只是简单的希望向微信环境下添加默认播放的背景音乐而不需要其他操作\"></a>如果只是简单的希望向微信环境下添加默认播放的背景音乐而不需要其他操作</h2><h3 id=\"给你的-js绑定微信浏览器特有的事件\"><a href=\"#给你的-js绑定微信浏览器特有的事件\" class=\"headerlink\" title=\"给你的 js绑定微信浏览器特有的事件\"></a>给你的 js绑定微信浏览器特有的事件</h3><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">audio</span> <span class=\"attr\">id</span>=<span class=\"string\">\"audio\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"media-audio\"</span> <span class=\"attr\">autoplay</span> <span class=\"attr\">preload</span> <span class=\"attr\">loop</span>=<span class=\"string\">\"loop\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">source</span> <span class=\"attr\">src</span>=<span class=\"string\">\"music.ogg\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"audio/ogg\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">source</span> <span class=\"attr\">src</span>=<span class=\"string\">\"music.mp3\"</span> <span class=\"attr\">type</span>=<span class=\"string\">\"audio/mpeg\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"comment\">&lt;!-- ... --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">audio</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"javascript\">   <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">audioAutoPlay</span>(<span class=\"params\">ID</span>)</span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">     <span class=\"keyword\">var</span> audio = <span class=\"built_in\">document</span>.getElementById(ID);</span></span><br><span class=\"line\">     audio.play();</span><br><span class=\"line\"><span class=\"javascript\">     <span class=\"built_in\">document</span>.addEventListener(<span class=\"string\">\"WeixinJSBridgeReady\"</span>, <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\">       audio.play();</span><br><span class=\"line\"><span class=\"javascript\">     &#125;, <span class=\"literal\">false</span>);</span></span><br><span class=\"line\"><span class=\"javascript\">     <span class=\"built_in\">document</span>.addEventListener(<span class=\"string\">'YixinJSBridgeReady'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\">       audio.play();</span><br><span class=\"line\"><span class=\"javascript\">     &#125;, <span class=\"literal\">false</span>);</span></span><br><span class=\"line\">   &#125;</span><br><span class=\"line\"><span class=\"javascript\">   audioAutoPlay(<span class=\"string\">'audio'</span>);</span></span><br><span class=\"line\"> <span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"如果有关于微信SDK的操作，将这段逻辑放在SDK中也是极好的\"><a href=\"#如果有关于微信SDK的操作，将这段逻辑放在SDK中也是极好的\" class=\"headerlink\" title=\"如果有关于微信SDK的操作，将这段逻辑放在SDK中也是极好的\"></a>如果有关于微信SDK的操作，将这段逻辑放在SDK中也是极好的</h2><h3 id=\"博主默认你已经正确的引用了-SDK，如果无法引用请查找其他文档\"><a href=\"#博主默认你已经正确的引用了-SDK，如果无法引用请查找其他文档\" class=\"headerlink\" title=\"博主默认你已经正确的引用了 SDK，如果无法引用请查找其他文档\"></a>博主默认你已经正确的引用了 SDK，如果无法引用请查找其他文档</h3><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// ...</span></span><br><span class=\"line\">wx.config(&#123;</span><br><span class=\"line\">  <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;)</span><br><span class=\"line\">wx.ready(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">  <span class=\"comment\">// ...</span></span><br><span class=\"line\">  audio.play();</span><br><span class=\"line\">  <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;)</span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure>\n","categories":[{"name":"weChat","path":"api/categories/weChat.json"}],"tags":[{"name":"weChat","path":"api/tags/weChat.json"},{"name":"audio","path":"api/tags/audio.json"}]}